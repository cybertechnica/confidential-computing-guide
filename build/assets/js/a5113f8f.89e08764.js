"use strict";(self.webpackChunkconfidential_computing_guide=self.webpackChunkconfidential_computing_guide||[]).push([[626],{4115:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var n=i(4848),r=i(8453);const s={sidebar_position:1},o="General overview and security features",a={id:"tpm/intro",title:"General overview and security features",description:"Security concepts",source:"@site/docs/tpm/1_intro.md",sourceDirName:"tpm",slug:"/tpm/intro",permalink:"/docs/tpm/intro",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tpm/1_intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Trusted Platform Modules (TPMs)",permalink:"/docs/category/trusted-platform-modules-tpms"},next:{title:"Try it, you already have it",permalink:"/docs/tpm/try_it"}},c={},d=[{value:"Security concepts",id:"security-concepts",level:2},{value:"Public-key certificate",id:"public-key-certificate",level:4},{value:"Privacy enablement in TPM",id:"privacy-enablement-in-tpm",level:4},{value:"TPM 2.0 specifications",id:"tpm-20-specifications",level:3},{value:"Enhanced Authorization",id:"enhanced-authorization",level:4},{value:"Quick Key Loading",id:"quick-key-loading",level:4},{value:"Non-Brittle PCRs",id:"non-brittle-pcrs",level:4},{value:"TPM Software Stack (TSS)",id:"tpm-software-stack-tss",level:3},{value:"A tale of keys",id:"a-tale-of-keys",level:3},{value:"Key provisioning",id:"key-provisioning",level:4},{value:"TPM Remote attestation",id:"tpm-remote-attestation",level:3},{value:"Attestation Procedure",id:"attestation-procedure",level:4},{value:"How PCRs are generated",id:"how-pcrs-are-generated",level:4},{value:"Information necessary for the attestation procedure",id:"information-necessary-for-the-attestation-procedure",level:4},{value:"Remote attestation connection flow",id:"remote-attestation-connection-flow",level:4},{value:"Security features",id:"security-features",level:3},{value:"Cryptographic attacks on TPMs",id:"cryptographic-attacks-on-tpms",level:3},{value:"NV Indexes",id:"nv-indexes",level:2},{value:"References",id:"references",level:2}];function l(e){const t={a:"a",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"general-overview-and-security-features",children:"General overview and security features"}),"\n",(0,n.jsx)(t.h2,{id:"security-concepts",children:"Security concepts"}),"\n",(0,n.jsx)(t.h4,{id:"public-key-certificate",children:"Public-key certificate"}),"\n",(0,n.jsx)(t.p,{children:"Trust comes from the public-key related to a specific TPM. A digital certificate is created that includes the public part of the key being certified and additional attributes of that key. The certificate is then signed by a certificate authority (CA) key."}),"\n",(0,n.jsx)(t.p,{children:"The TPM, in his limited-resource capability, does not create nor consumes X.509 certificates. But it does store some X.509 certificates (according to the TCG)."}),"\n",(0,n.jsx)(t.p,{children:"two certification processes :"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The TPM vendor and platform manufacturer may provision the TPM with"}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"privacy-enablement-in-tpm",children:"Privacy enablement in TPM"}),"\n",(0,n.jsx)(t.p,{children:"A privacy-related problem that was hard to solve is : providing a means to prove that a key was created and was protected by a TPM without the recipient of that proof knowing which was the creator and protector of the key."}),"\n",(0,n.jsx)(t.p,{children:"the Endorsement Key (EK) is used only as a decryption-only key, as opposed to a signing key, it can't be directly used to identify a particular TPM."}),"\n",(0,n.jsxs)(t.p,{children:["Instead, a protocol is provided to make ",(0,n.jsx)(t.em,{children:"Attestation Identity keys"})," (AIK)s which are pseudo-identity keys for the platform."]}),"\n",(0,n.jsx)(t.p,{children:"EKs can be used to prove that an AIK originated with a TPM without proving which TPM the AIK originated from.  We can also have an unlimited number of AIKs for different uses, that can be destroyed after creation and use."}),"\n",(0,n.jsxs)(t.p,{children:["Additionally, a protocol called ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Direct_Anonymous_Attestation",children:"Direct Anonymous Attestation (DAA)"})," for proving that a key was created by a TPM without providing information as to which TPM created it."]}),"\n",(0,n.jsx)(t.h3,{id:"tpm-20-specifications",children:"TPM 2.0 specifications"}),"\n",(0,n.jsx)(t.h4,{id:"enhanced-authorization",children:"Enhanced Authorization"}),"\n",(0,n.jsx)(t.h4,{id:"quick-key-loading",children:"Quick Key Loading"}),"\n",(0,n.jsx)(t.h4,{id:"non-brittle-pcrs",children:"Non-Brittle PCRs"}),"\n",(0,n.jsx)(t.h3,{id:"tpm-software-stack-tss",children:"TPM Software Stack (TSS)"}),"\n",(0,n.jsx)(t.p,{children:"Levels of abstraction :"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Feature API (FAPI)"})," : Used for most applications, exposes the API for TPM features."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Enhanced System API (ESAPI)"})," : Needs a deeper knowledge of TPM, and provides session management and support for cryptographic operations."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"System API (SAPI)"})," : Requires much more TPM knowledge. It provides access to all the functionalities but requires a high level of knowledge."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"TPM Command Interface (TCTI)"})," : used for sending commands and receiving responses."]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.em,{children:"TPM Access Broker (TAB)"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.em,{children:"Resource Manager (RM)"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Device Driver"})," : Physical transmission of data to and from the TPM."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"a-tale-of-keys",children:"A tale of keys"}),"\n",(0,n.jsx)(t.p,{children:"In this section we are going to talk about the different keys. The ones that can be used, the ones that must be protected, and the ones that are saved."}),"\n",(0,n.jsx)(t.h4,{id:"key-provisioning",children:"Key provisioning"}),"\n",(0,n.jsx)(t.p,{children:"Two-types of provisioning for the TPM root-of-trust :"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Attestation and identities -> initial"}),"\n",(0,n.jsx)(t.li,{children:"part of the device onboarding and deployment -> local"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:'A TPM pre-provisioned with only an EK may provision "Initial" keys at different stages.\nTPMs supports provisioning that happens over different stages.'}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:(0,n.jsx)(t.strong,{children:"Primary endorsement key (PEK) :"})}),"\nTPMs vendors provision the TPM device with a Primary Endorsement Key (PEK) and generate a certificate for that key (EK cert) in X.509 format at the time of manufacture.\nThe EK cert contains the public part of the PEK And other information such as TPM manufacturer name, part model, part version, key id, etc.\nThis information is used to uniquely identify the TPM and if the device OEM (Original Equipment Manufacturer)  securely attaches a TPM to the device it can be used as a device identifier.\nThe EK certificate may be stored in the TPM Non Volatile Memory (NVM), where it can be made available to client software or directly from the OEM's website.\nThe EK certificate is signed (issued) by the TPM vendor's CA and verifiers are assumed to trust the vendor's root certificate.\nThe private of the EK is expected to never be exposed outside of the TPM."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:(0,n.jsx)(t.strong,{children:"Endorsement Keys (EKs) :"})}),"\nSince TPM 2.0, we can have more than one Endorsement Key (EK). The algorithm flexibility allows the TPM to create EKs of any type asymmetric algorithm implemented in the TPM."]}),"\n",(0,n.jsxs)(t.p,{children:["The properties of the Endorsement Key are expressed by its public area template. Creating two EK with the same template will result in the same key. The EK and its credential may be considered ",(0,n.jsx)(t.strong,{children:"privacy-sensitive"})," if the private part of the EK is used in a cryptographic protocol. the EK ",(0,n.jsx)(t.strong,{children:"Should not be"})," used as a ",(0,n.jsx)(t.strong,{children:"signing key"})," for privacy-sensitive purposes."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_Credential_Profile_EK_V2.1_R13.pdf",children:"https://trustedcomputinggroup.org/wp-content/uploads/TCG_IWG_Credential_Profile_EK_V2.1_R13.pdf"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.em,{children:(0,n.jsx)(t.strong,{children:"Primary Attestation Key (PAK) :"})})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.em,{children:(0,n.jsx)(t.strong,{children:"Initial Attestation Key (IAK) :"})}),"\nThe OEM may also generate Initial Attestation Key (IAK) and IAK certificate"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.em,{children:(0,n.jsx)(t.strong,{children:"Primary Storage Key (PSK) :"})})}),"\n",(0,n.jsx)(t.h3,{id:"tpm-remote-attestation",children:"TPM Remote attestation"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://tpm2-software.github.io/2020/06/12/Remote-Attestation-With-tpm2-tools.html",children:"https://tpm2-software.github.io/2020/06/12/Remote-Attestation-With-tpm2-tools.html"}),"\nRemote attestation is the mechanism that is built to establish trust with a remote device through attestation.\nPlatform anonymity."]}),"\n",(0,n.jsx)(t.h4,{id:"attestation-procedure",children:"Attestation Procedure"}),"\n",(0,n.jsx)(t.p,{children:"Before a system can be attested the owner needs to obtain the public key of the TPM Vendor EK and OEM generated Attestation Key along with the appropriate certificates."}),"\n",(0,n.jsx)(t.h4,{id:"how-pcrs-are-generated",children:"How PCRs are generated"}),"\n",(0,n.jsx)(t.p,{children:"Platform Configuration Registers (PCRs) are special TPM2 objects that can only be modified or written by hash extension mechanism. The new hash replaces the old one after each extension. PCRs are arranged in banks depending on the hashing algorithm used. Every bank has up to 32 PCRs values available."}),"\n",(0,n.jsx)(t.h4,{id:"information-necessary-for-the-attestation-procedure",children:"Information necessary for the attestation procedure"}),"\n",(0,n.jsx)(t.h4,{id:"remote-attestation-connection-flow",children:"Remote attestation connection flow"}),"\n",(0,n.jsx)(t.h3,{id:"security-features",children:"Security features"}),"\n",(0,n.jsx)(t.h3,{id:"cryptographic-attacks-on-tpms",children:"Cryptographic attacks on TPMs"}),"\n",(0,n.jsx)(t.h2,{id:"nv-indexes",children:"NV Indexes"}),"\n",(0,n.jsx)(t.p,{children:"For Non-Volatile indexes.\nIn the TPM we can use the non-volatile memory for two different classes of data :"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Data Structures defined by the TPM"}),"\n",(0,n.jsx)(t.li,{children:"Unstructured data defined by a user or a platform specific spec."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["presentation :\n",(0,n.jsx)(t.a,{href:"https://static.sched.com/hosted_files/osseu2020/26/Oct_29_Introducing%20TPM%20NV%20Storage%20with%20EA%20Policies%20and%20TSS-FAPI_Andreas%20Fuchs.pdf",children:"https://static.sched.com/hosted_files/osseu2020/26/Oct_29_Introducing%20TPM%20NV%20Storage%20with%20EA%20Policies%20and%20TSS-FAPI_Andreas%20Fuchs.pdf"})]}),"\n",(0,n.jsx)(t.h2,{id:"references",children:"References"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://cloud.google.com/blog/products/identity-security/virtual-trusted-platform-module-for-shielded-vms-security-in-plaintext?hl=en",children:"https://cloud.google.com/blog/products/identity-security/virtual-trusted-platform-module-for-shielded-vms-security-in-plaintext?hl=en"}),"\n",(0,n.jsx)(t.a,{href:"https://link.springer.com/book/10.1007/978-1-4302-6584-9",children:"https://link.springer.com/book/10.1007/978-1-4302-6584-9"})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var n=i(6540);const r={},s=n.createContext(r);function o(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);